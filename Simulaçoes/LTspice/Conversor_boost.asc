Version 4
SHEET 1 2244 924
WIRE 256 -32 32 -32
WIRE 304 -32 256 -32
WIRE 416 -32 304 -32
WIRE 512 -32 416 -32
WIRE -1104 16 -1200 16
WIRE -928 16 -976 16
WIRE 32 16 32 -32
WIRE 256 16 256 -32
WIRE 304 16 304 -32
WIRE 416 16 416 -32
WIRE 512 16 512 -32
WIRE -704 32 -768 32
WIRE -416 32 -464 32
WIRE -1104 48 -1136 48
WIRE 464 48 448 48
WIRE -416 64 -464 64
WIRE -416 96 -464 96
WIRE 96 96 80 96
WIRE 256 112 256 80
WIRE 304 112 304 80
WIRE 304 112 256 112
WIRE -1136 128 -1136 48
WIRE -1088 128 -1136 128
WIRE -768 128 -768 32
WIRE 416 128 416 96
WIRE 512 128 512 96
WIRE 512 128 416 128
WIRE -208 160 -272 160
WIRE -128 160 -208 160
WIRE 32 160 32 112
WIRE 32 160 -48 160
WIRE 96 160 32 160
WIRE 304 160 304 112
WIRE 416 160 416 128
WIRE -1200 176 -1200 16
WIRE 800 176 704 176
WIRE 1040 176 992 176
WIRE -272 208 -272 160
WIRE -208 208 -208 160
WIRE 32 208 32 160
WIRE -768 240 -768 208
WIRE 800 240 304 240
WIRE 1040 240 992 240
WIRE 304 256 304 240
WIRE 704 256 704 176
WIRE -1200 272 -1200 256
WIRE 112 288 80 288
WIRE -272 320 -272 272
WIRE -208 320 -208 272
WIRE -208 320 -272 320
WIRE -272 352 -272 320
WIRE 32 352 32 304
WIRE 304 352 304 336
WIRE 704 352 704 336
FLAG 304 160 0
FLAG 416 160 0
FLAG 416 -32 Vbus
FLAG -1088 128 I2
IOPIN -1088 128 In
FLAG -928 16 erroSC
IOPIN -928 16 Out
FLAG -416 32 HSC
IOPIN -416 32 BiDir
FLAG -416 96 LSC
IOPIN -416 96 BiDir
FLAG -416 64 MSC
IOPIN -416 64 BiDir
FLAG -272 352 0
FLAG 112 288 LSC
IOPIN 112 288 BiDir
FLAG 32 352 0
FLAG 96 160 MSC
IOPIN 96 160 BiDir
FLAG 96 96 HSC
IOPIN 96 96 BiDir
FLAG -272 160 Vsc
FLAG -768 240 0
FLAG 304 352 0
FLAG 304 240 Isc
FLAG 1040 240 I2
IOPIN 1040 240 Out
FLAG 1040 176 Vd
IOPIN 1040 176 Out
FLAG 704 352 0
FLAG 464 48 w
FLAG -1200 16 ref
FLAG -1200 272 0
SYMBOL cap 288 16 R0
SYMATTR InstName C1
SYMATTR Value 680µ
SYMATTR SpiceLine V=100 Rser=15m Lser=500p Rpar=12Meg
SYMBOL cap 240 16 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL carga_motor 384 16 R0
SYMATTR InstName X1
SYMBOL controladorPI -1040 32 R0
WINDOW 39 0 -23 Bottom 2
SYMATTR SpiceLine P=.4 I=1000 max=60
SYMATTR InstName X4
SYMBOL ind -144 176 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 120µ
SYMATTR SpiceLine Ipk=29 Rser=19m
SYMBOL cap -288 208 R0
SYMATTR InstName C2
SYMATTR Value 66
SYMATTR SpiceLine Irms=80 Rser=20m Rpar=8k
SYMBOL cap -224 208 R0
SYMATTR InstName C4
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=1m Lser=1n
SYMBOL modulador_PWM_driver -592 64 R0
SYMATTR InstName X7
SYMBOL nmos 80 16 M0
WINDOW 3 56 60 Left 2
SYMATTR Value irfz44n
SYMATTR InstName M3
SYMATTR Prefix X
SYMBOL nmos 80 208 M0
WINDOW 3 56 60 Left 2
SYMATTR Value irfz44n
SYMATTR InstName M4
SYMATTR Prefix X
SYMBOL bv -768 112 R0
SYMATTR InstName B3
SYMATTR Value V= 1/pow( limit( 1, V(erroSC), 10 ), 2 )
SYMBOL bv 304 240 R0
SYMATTR InstName B2
SYMATTR Value V=I(L2)+.1*rand(time*1e5)-.05
SYMBOL frontend_analog 896 176 R0
SYMATTR InstName X3
SYMBOL bv 704 240 R0
SYMATTR InstName B4
SYMATTR Value V=V(Vbus)+.1*random(time*1e5)-.05
SYMBOL res 496 0 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL voltage -1200 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
WINDOW 3 39 87 Left 2
SYMATTR Value 10
SYMATTR InstName V1
TEXT 632 112 Left 2 !.tran 2
TEXT -272 -16 Left 2 !.ic V(Vsc)=7\n.ic I(L2)=0\n.ic V(Vbus)=0
TEXT 624 -32 Left 2 !.options reltol=1e-3\n.options gmin 1e-10\n.options maxstep=2.6u
TEXT 624 80 Left 2 !.inc irfz44n.spi
